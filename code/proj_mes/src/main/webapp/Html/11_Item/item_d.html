<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>신규 품목 등록</title>
    <!-- 깨끗하고 현대적인 느낌을 주는 Inter 폰트 사용 -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 동적 차트를 위한 Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        .header-bg {
            background-color: #002a40;
        }

        .nav-bg {
            background-color: #003751;
        }

        /* 메인 내비게이션 목록의 호버 배경색을 파란색으로 변경하여 글씨가 잘 보이게 수정 */
        .mainList li:hover {
            background-color: #3b82f6;
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-800">

    <!-- 헤더 섹션 -->
    <header class="header-bg text-white p-4 shadow-lg flex justify-between items-center z-50 relative">
        <div class="flex items-center space-x-2">
            <img src="https://i.postimg.cc/qMsq73hD/icon.png" class="w-10" alt="회사 로고">
            <h3 class="text-xl font-bold">J2P4</h3>
        </div>
        <div class="flex items-center space-x-4 sm:space-x-8">
            <div class="search cursor-pointer">
                <img src="https://i.postimg.cc/9QcMwQym/magnifier-white.png" class="w-6 sm:w-7" alt="검색용 아이콘">
            </div>
            <div class="logout text-sm sm:text-base cursor-pointer hover:underline">
                로그아웃
            </div>
            <div class="myIcon relative">
                <a href="javascript:void(0);" id="myIconBtn">
                    <img src="https://i.postimg.cc/zfVqTbvr/user.png" class="w-8 sm:w-9 rounded-full bg-white" alt="마이페이지 아이콘">
                </a>
            </div>
        </div>
    </header>
    <!-- 메인 내비게이션 -->
    <nav class="nav-bg text-white py-2 shadow-inner z-40 relative">
        <ul class="mainList flex flex-wrap justify-center text-sm sm:text-base">
            <li class="relative px-2 sm:px-4 py-2 rounded-md">기준 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">공정 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">BOM 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">발주 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">재고 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">생산 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">품질 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">품목 관리</li>
        </ul>
    </nav>

    <div class="p-4 sm:p-8 max-w-7xl mx-auto">
        <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-6"></h2>
        <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-xl p-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">신규 품목 등록</h2>
            <form id="itemRegisterForm" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- 품목 코드 -->
                    <div>
                        <label for="itemCode" class="block text-sm font-medium text-gray-700 mb-1">품목 코드</label>
                        <input type="text" id="itemCode" name="itemCode"
                            class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <!-- 품목명 -->
                    <div>
                        <label for="itemName" class="block text-sm font-medium text-gray-700 mb-1">품목명</label>
                        <input type="text" id="itemName" name="itemName"
                            class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <!-- 단가 -->
                    <div>
                        <label for="itemPrice" class="block text-sm font-medium text-gray-700 mb-1">단가</label>
                        <input type="text" id="itemPrice" name="itemPrice"
                            class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <!-- 품목 유형 -->
                    <div>
                        <label for="itemType" class="block text-sm font-medium text-gray-700 mb-1">품목 유형</label>
                        <select id="itemType" name="itemType"
                            class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <option value="완제품">완제품</option>
                            <option value="소모품">소모품</option>
                            <option value="원자재">원자재</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-end mt-6">
                    <button type="submit" id="saveBtn"
                        class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-blue-700 transition-colors">저장</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 커스텀 메시지 모달 (2버튼용으로 수정) -->
    <div id="messageModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm">
            <p id="modalMessage" class="text-center text-gray-800 mb-4 font-semibold"></p>
            <div class="flex justify-center space-x-4">
                <button id="modalOkBtn" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none">확인</button>
                <button id="modalCancelBtn" class="bg-gray-400 text-white px-4 py-2 rounded-md hover:bg-gray-500 focus:outline-none hidden">취소</button>
            </div>
        </div>
    </div>

    <script>
        /**
         * 커스텀 메시지 모달을 표시하는 함수 (단일 버튼)
         * @param {string} message - 모달에 표시할 메시지
         */
        function showMessage(message) {
            const modal = document.getElementById('messageModal');
            const modalMessage = document.getElementById('modalMessage');
            const modalOkBtn = document.getElementById('modalOkBtn');
            const modalCancelBtn = document.getElementById('modalCancelBtn');

            modalMessage.innerHTML = message;
            modalCancelBtn.classList.add('hidden'); // 취소 버튼 숨기기
            modal.classList.remove('hidden');

            modalOkBtn.onclick = () => {
                modal.classList.add('hidden');
            };
        }

        /**
         * 커스텀 확인 모달을 표시하는 함수 (확인/취소 버튼)
         * @param {string} message - 모달에 표시할 메시지
         * @returns {Promise<boolean>} - 사용자가 '확인'을 누르면 true, '취소'를 누르면 false를 반환하는 Promise
         */
        function showConfirmation(message) {
            return new Promise(resolve => {
                const modal = document.getElementById('messageModal');
                const modalMessage = document.getElementById('modalMessage');
                const modalOkBtn = document.getElementById('modalOkBtn');
                const modalCancelBtn = document.getElementById('modalCancelBtn');

                modalMessage.innerHTML = message;
                modalCancelBtn.classList.remove('hidden'); // 취소 버튼 보이기
                modal.classList.remove('hidden');

                modalOkBtn.onclick = () => {
                    modal.classList.add('hidden');
                    resolve(true);
                };

                modalCancelBtn.onclick = () => {
                    modal.classList.add('hidden');
                    resolve(false);
                };
            });
        }

        // DOM이 완전히 로드된 후 실행
        window.addEventListener('load', () => {
            // DOM 요소 가져오기
            const form = document.getElementById('itemRegisterForm');

            // 폼 제출 이벤트 리스너 추가
            form.addEventListener('submit', async (e) => {
                e.preventDefault(); // 기본 폼 제출 방지

                // 모든 필드가 채워져 있는지 확인
                const itemData = {
                    itemCode: form.itemCode.value,
                    itemName: form.itemName.value,
                    itemPrice: form.itemPrice.value,
                    itemType: form.itemType.value,
                    timestamp: new Date().toISOString() // ISO 형식으로 저장
                };

                if (!itemData.itemCode || !itemData.itemName || !itemData.itemPrice || !itemData.itemType) {
                    showMessage('모든 항목을 입력해주세요.');
                    return;
                }
                
                // 단가 필드가 숫자인지 확인
                if (isNaN(itemData.itemPrice)) {
                    showMessage('단가는 숫자로 입력해주세요.');
                    return;
                }

                const confirmedSave = await showConfirmation('저장하시겠습니까?');
                if (!confirmedSave) {
                    return;
                }

                try {
                    console.log("품목 저장 시도:", itemData);
                    
                    // 로컬 저장소에 데이터 추가
                    const items = JSON.parse(localStorage.getItem('registeredItems')) || [];
                    items.push(itemData);
                    localStorage.setItem('registeredItems', JSON.stringify(items));

                    console.log("로컬 저장소에 성공적으로 저장되었습니다!");
                    console.log("현재 저장된 품목 목록:", items);
                    
                    const confirmedMove = await showConfirmation('품목이 성공적으로 저장되었습니다.<br>목록으로 이동하시겠습니까?');
                    if (confirmedMove) {
                        // 목록 페이지로 이동
                        window.location.href = "item.html";
                    } else {
                        // 현재 페이지에 그대로 남아있기 위해 폼 초기화
                        form.reset();
                    }

                } catch (error) {
                    console.error("데이터 저장 중 오류 발생:", error);
                    showMessage('등록에 실패했습니다. 다시 시도해주세요.');
                }
            });
        });
    </script>
</body>
</html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>신규 품목 등록</title>
    <!-- 깨끗하고 현대적인 느낌을 주는 Inter 폰트 사용 -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 동적 차트를 위한 Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        .header-bg {
            background-color: #002a40;
        }

        .nav-bg {
            background-color: #003751;
        }

        /* 메인 내비게이션 목록의 호버 배경색을 파란색으로 변경하여 글씨가 잘 보이게 수정 */
        .mainList li:hover {
            background-color: #3b82f6;
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-800">

    <!-- 헤더 섹션 -->
    <header class="header-bg text-white p-4 shadow-lg flex justify-between items-center z-50 relative">
        <div class="flex items-center space-x-2">
            <img src="https://i.postimg.cc/qMsq73hD/icon.png" class="w-10" alt="회사 로고">
            <h3 class="text-xl font-bold">J2P4</h3>
        </div>
        <div class="flex items-center space-x-4 sm:space-x-8">
            <div class="search cursor-pointer">
                <img src="https://i.postimg.cc/9QcMwQym/magnifier-white.png" class="w-6 sm:w-7" alt="검색용 아이콘">
            </div>
            <div class="logout text-sm sm:text-base cursor-pointer hover:underline">
                로그아웃
            </div>
            <div class="myIcon relative">
                <a href="javascript:void(0);" id="myIconBtn">
                    <img src="https://i.postimg.cc/zfVqTbvr/user.png" class="w-8 sm:w-9 rounded-full bg-white" alt="마이페이지 아이콘">
                </a>
            </div>
        </div>
    </header>
    <!-- 메인 내비게이션 -->
    <nav class="nav-bg text-white py-2 shadow-inner z-40 relative">
        <ul class="mainList flex flex-wrap justify-center text-sm sm:text-base">
            <li class="relative px-2 sm:px-4 py-2 rounded-md">기준 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">공정 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">BOM 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">발주 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">재고 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">생산 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">품질 관리</li>
            <li class="relative px-2 sm:px-4 py-2 rounded-md">품목 관리</li>
        </ul>
    </nav>

    <div class="p-4 sm:p-8 max-w-7xl mx-auto">
        <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-6"></h2>
        <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-xl p-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">신규 품목 등록</h2>
            <form id="itemRegisterForm" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- 품목 코드 -->
                    <div>
                        <label for="itemCode" class="block text-sm font-medium text-gray-700 mb-1">품목 코드</label>
                        <input type="text" id="itemCode" name="itemCode"
                            class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <!-- 품목명 -->
                    <div>
                        <label for="itemName" class="block text-sm font-medium text-gray-700 mb-1">품목명</label>
                        <input type="text" id="itemName" name="itemName"
                            class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <!-- 단가 -->
                    <div>
                        <label for="itemPrice" class="block text-sm font-medium text-gray-700 mb-1">단가</label>
                        <input type="text" id="itemPrice" name="itemPrice"
                            class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <!-- 품목 유형 -->
                    <div>
                        <label for="itemType" class="block text-sm font-medium text-gray-700 mb-1">품목 유형</label>
                        <select id="itemType" name="itemType"
                            class="mt-1 block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <option value="완제품">완제품</option>
                            <option value="소모품">소모품</option>
                            <option value="원자재">원자재</option>
                        </select>
                    </div>
                </div>
                <div class="flex justify-end mt-6">
                    <button type="submit" id="saveBtn"
                        class="bg-blue-600 text-white font-semibold py-2 px-6 rounded-md hover:bg-blue-700 transition-colors">저장</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 커스텀 메시지 모달 (2버튼용으로 수정) -->
    <div id="messageModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm">
            <p id="modalMessage" class="text-center text-gray-800 mb-4 font-semibold"></p>
            <div class="flex justify-center space-x-4">
                <button id="modalOkBtn" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none">확인</button>
                <button id="modalCancelBtn" class="bg-gray-400 text-white px-4 py-2 rounded-md hover:bg-gray-500 focus:outline-none hidden">취소</button>
            </div>
        </div>
    </div>

    <script>
        /**
         * 커스텀 메시지 모달을 표시하는 함수 (단일 버튼)
         * @param {string} message - 모달에 표시할 메시지
         */
        function showMessage(message) {
            const modal = document.getElementById('messageModal');
            const modalMessage = document.getElementById('modalMessage');
            const modalOkBtn = document.getElementById('modalOkBtn');
            const modalCancelBtn = document.getElementById('modalCancelBtn');

            modalMessage.innerHTML = message;
            modalCancelBtn.classList.add('hidden'); // 취소 버튼 숨기기
            modal.classList.remove('hidden');

            modalOkBtn.onclick = () => {
                modal.classList.add('hidden');
            };
        }

        /**
         * 커스텀 확인 모달을 표시하는 함수 (확인/취소 버튼)
         * @param {string} message - 모달에 표시할 메시지
         * @returns {Promise<boolean>} - 사용자가 '확인'을 누르면 true, '취소'를 누르면 false를 반환하는 Promise
         */
        function showConfirmation(message) {
            return new Promise(resolve => {
                const modal = document.getElementById('messageModal');
                const modalMessage = document.getElementById('modalMessage');
                const modalOkBtn = document.getElementById('modalOkBtn');
                const modalCancelBtn = document.getElementById('modalCancelBtn');

                modalMessage.innerHTML = message;
                modalCancelBtn.classList.remove('hidden'); // 취소 버튼 보이기
                modal.classList.remove('hidden');

                modalOkBtn.onclick = () => {
                    modal.classList.add('hidden');
                    resolve(true);
                };

                modalCancelBtn.onclick = () => {
                    modal.classList.add('hidden');
                    resolve(false);
                };
            });
        }

        // DOM이 완전히 로드된 후 실행
        window.addEventListener('load', () => {
            // DOM 요소 가져오기
            const form = document.getElementById('itemRegisterForm');

            // 폼 제출 이벤트 리스너 추가
            form.addEventListener('submit', async (e) => {
                e.preventDefault(); // 기본 폼 제출 방지

                // 모든 필드가 채워져 있는지 확인
                const itemData = {
                    itemCode: form.itemCode.value,
                    itemName: form.itemName.value,
                    itemPrice: form.itemPrice.value,
                    itemType: form.itemType.value,
                    timestamp: new Date().toISOString() // ISO 형식으로 저장
                };

                if (!itemData.itemCode || !itemData.itemName || !itemData.itemPrice || !itemData.itemType) {
                    showMessage('모든 항목을 입력해주세요.');
                    return;
                }
                
                // 단가 필드가 숫자인지 확인
                if (isNaN(itemData.itemPrice)) {
                    showMessage('단가는 숫자로 입력해주세요.');
                    return;
                }

                const confirmedSave = await showConfirmation('저장하시겠습니까?');
                if (!confirmedSave) {
                    return;
                }

                try {
                    console.log("품목 저장 시도:", itemData);
                    
                    // 로컬 저장소에 데이터 추가
                    const items = JSON.parse(localStorage.getItem('registeredItems')) || [];
                    items.push(itemData);
                    localStorage.setItem('registeredItems', JSON.stringify(items));

                    console.log("로컬 저장소에 성공적으로 저장되었습니다!");
                    console.log("현재 저장된 품목 목록:", items);
                    
                    const confirmedMove = await showConfirmation('품목이 성공적으로 저장되었습니다.<br>목록으로 이동하시겠습니까?');
                    if (confirmedMove) {
                        // 목록 페이지로 이동
                        window.location.href = "item.html";
                    } else {
                        // 현재 페이지에 그대로 남아있기 위해 폼 초기화
                        form.reset();
                    }

                } catch (error) {
                    console.error("데이터 저장 중 오류 발생:", error);
                    showMessage('등록에 실패했습니다. 다시 시도해주세요.');
                }
            });
        });
    </script>
</body>
</html>
